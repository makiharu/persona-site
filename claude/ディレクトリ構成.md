# ディレクトリ構成.md

## 1. 基本方針

- Next.js App Router を採用
- MVP（Minimum Viable Product）を最短で成立させる
- Zustand / Prisma を学習目的込みで実戦投入
- 責務が明確で、後から拡張しやすい構成にする

---

## 2. 全体構成

src/
app/
components/
stores/
lib/
types/
prisma/

yaml
コードをコピーする

---

## 3. app ディレクトリ（画面・API）

app/
(public)/
page.tsx
scenes/
[sceneId]/
page.tsx
quiz/
[sceneId]/
page.tsx
login/
page.tsx

(authed)/
progress/
page.tsx
review/
page.tsx

api/
auth/
[...nextauth]/
route.ts
scenes/
route.ts
phrases/
route.ts
progress/
route.ts
review/
queue/
route.ts
speech/
evaluate/
route.ts

markdown
コードをコピーする

### (public)
- ログイン不要で利用可能
- MVPの主要体験を提供

- `page.tsx`  
  - トップ画面（シーン一覧）

- `scenes/[sceneId]/page.tsx`  
  - シーン詳細・クイズ開始導線

- `quiz/[sceneId]/page.tsx`  
  - クイズ画面（音声 / 音声なし）
  - Zustand を使用

- `login/page.tsx`  
  - 任意ログイン画面

---

### (authed)
- ログインユーザー専用画面

- `progress/page.tsx`  
  - シーン別学習進捗

- `review/page.tsx`  
  - 復習キュー（間違い・フラグ付き）

---

### api
- Route Handlers
- フロントと型を共有する前提

- `scenes`  
  - シーン一覧取得

- `phrases`  
  - シーン別フレーズ取得

- `progress`  
  - 学習結果保存（正解 / 不正解 / フラグ）

- `review/queue`  
  - 復習対象フレーズ取得

- `speech/evaluate`  
  - 音声判定（MVPでは未実装可）

---

## 4. components（UIコンポーネント）

components/
scene/
SceneCard.tsx
quiz/
QuizCard.tsx
ModeToggle.tsx
AnswerFeedback.tsx
progress/
ProgressSummary.tsx
PhraseChecklist.tsx

yaml
コードをコピーする

- 表示・操作に専念
- ビジネスロジックは持たせない

---

## 5. stores（Zustand）

stores/
quizStore.ts
reviewStore.ts

yaml
コードをコピーする

### quizStore.ts
- 現在の問題番号
- 正解 / 不正解数
- モード（音声 / 音声なし）
- フラグ操作

### reviewStore.ts
- 復習対象の一時管理

---

## 6. lib（ロジック・外部依存）

lib/
db/
prisma.ts
auth/
options.ts
scoring/
textSimilarity.ts
srs/
scheduler.ts
storage/
guestProgress.ts

markdown
コードをコピーする

- `prisma.ts`  
  - Prisma Client 初期化

- `scoring`  
  - 英文類似度・採点ロジック

- `srs`  
  - 復習スケジューリング

- `storage`  
  - 未ログインユーザー用ローカル保存

---

## 7. types（型定義）

types/
domain.ts

yaml
コードをコピーする

- Scene / Phrase / Progress / ReviewItem など
- Prisma 型と UI 型の橋渡し

---

## 8. prisma（DB設計）

prisma/
schema.prisma

yaml
コードをコピーする

- DB設計の中核
- 設計書兼実装

---

## 9. この構成の狙い

- MVPでも破綻しない
- Zustand / Prisma の責務が明確
- 迷わず実装に集中できる
- 機能追加・拡張がしやすい

